{"version":3,"file":"clean-basic-html.js","sources":["../lib/clean-basic-html.js"],"sourcesContent":["/* global DOMParser, window */\nexport default function cleanBasicHtml(html = '', _options = {}) {\n    const defaults = {};\n    const options = Object.assign({}, defaults, _options);\n\n    if (!options.createDocument) {\n        const Parser = (typeof DOMParser !== 'undefined' && DOMParser) || (typeof window !== 'undefined' && window.DOMParser);\n\n        if (!Parser) {\n            throw new Error('cleanBasicHtml() must be passed a `createDocument` function as an option when used in a non-browser environment');\n        }\n\n        options.createDocument = function (html) {\n            const parser = new Parser();\n            return parser.parseFromString(html, 'text/html');\n        };\n    }\n\n    let cleanHtml = html\n        .replace(/<br\\s?\\/?>/g, ' ')\n        .replace(/(\\s|&nbsp;){2,}/g, ' ')\n        .trim()\n        .replace(/^&nbsp;|&nbsp$/g, '')\n        .trim();\n\n    // remove any elements that have a blank textContent\n    if (cleanHtml) {\n        let doc = options.createDocument(cleanHtml);\n\n        doc.body.querySelectorAll('*').forEach((element) => {\n            if (!element.textContent.trim()) {\n                if (element.textContent.length > 0) {\n                    // keep a single space to avoid collapsing spaces\n                    let space = doc.createTextNode(' ');\n                    element.replaceWith(space);\n                } else {\n                    element.remove();\n                }\n            }\n        });\n\n        cleanHtml = doc.body.innerHTML.trim();\n    }\n\n    return cleanHtml;\n}\n"],"names":["cleanBasicHtml","html","_options","defaults","options","Object","assign","createDocument","Parser","DOMParser","window","Error","parser","parseFromString","cleanHtml","replace","trim","doc","body","querySelectorAll","forEach","element","textContent","length","space","createTextNode","replaceWith","remove","innerHTML"],"mappings":"AAAA;AACA,AAAe,SAASA,cAAT,CAAwBC,IAAI,GAAG,EAA/B,EAAmCC,QAAQ,GAAG,EAA9C,EAAkD;QACvDC,QAAQ,GAAG,EAAjB;QACMC,OAAO,GAAGC,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkBH,QAAlB,EAA4BD,QAA5B,CAAhB;;MAEI,CAACE,OAAO,CAACG,cAAb,EAA6B;UACnBC,MAAM,GAAI,OAAOC,SAAP,KAAqB,WAArB,IAAoCA,SAArC,IAAoD,OAAOC,MAAP,KAAkB,WAAlB,IAAiCA,MAAM,CAACD,SAA3G;;QAEI,CAACD,MAAL,EAAa;YACH,IAAIG,KAAJ,CAAU,iHAAV,CAAN;;;IAGJP,OAAO,CAACG,cAAR,GAAyB,UAAUN,IAAV,EAAgB;YAC/BW,MAAM,GAAG,IAAIJ,MAAJ,EAAf;aACOI,MAAM,CAACC,eAAP,CAAuBZ,IAAvB,EAA6B,WAA7B,CAAP;KAFJ;;;MAMAa,SAAS,GAAGb,IAAI,CACfc,OADW,CACH,aADG,EACY,GADZ,EAEXA,OAFW,CAEH,kBAFG,EAEiB,GAFjB,EAGXC,IAHW,GAIXD,OAJW,CAIH,iBAJG,EAIgB,EAJhB,EAKXC,IALW,EAAhB,CAjB6D;;MAyBzDF,SAAJ,EAAe;QACPG,GAAG,GAAGb,OAAO,CAACG,cAAR,CAAuBO,SAAvB,CAAV;IAEAG,GAAG,CAACC,IAAJ,CAASC,gBAAT,CAA0B,GAA1B,EAA+BC,OAA/B,CAAwCC,OAAD,IAAa;UAC5C,CAACA,OAAO,CAACC,WAAR,CAAoBN,IAApB,EAAL,EAAiC;YACzBK,OAAO,CAACC,WAAR,CAAoBC,MAApB,GAA6B,CAAjC,EAAoC;;cAE5BC,KAAK,GAAGP,GAAG,CAACQ,cAAJ,CAAmB,GAAnB,CAAZ;UACAJ,OAAO,CAACK,WAAR,CAAoBF,KAApB;SAHJ,MAIO;UACHH,OAAO,CAACM,MAAR;;;KAPZ;IAYAb,SAAS,GAAGG,GAAG,CAACC,IAAJ,CAASU,SAAT,CAAmBZ,IAAnB,EAAZ;;;SAGGF,SAAP;;;;;"}